<html>
    <head>
        <title>WebSocket Remote Game Controller</title>
    </head>
    <body>
        <script type="text/javascript">
            var websocket = null;
            try {
                if (typeof MozWebSocket == 'function')
                    WebSocket = MozWebSocket;
                var wsUri = window.location.protocol.replace('http', 'ws') + '//' + window.location.host
                websocket = new WebSocket( wsUri );
                websocket.onopen = function (evt) {
                    console.log("CONNECTED");
                };
                websocket.onclose = function (evt) {
                    console.log("DISCONNECTED");
                };
                websocket.onmessage = function (evt) {
                    console.log( "Message received :", evt.data );
                    console.log( evt.data );
                };
                websocket.onerror = function (evt) {
                    console.log('ERROR: ' + evt.data);
                };
            } catch (exception) {
                console.log('ERROR: ' + exception);
            }

            function handleMouseMove(e){
                websocket.send(JSON.stringify({x: e.clientX, y: e.clientY}));
            }
            function handleTouchStart(e) {
                e.preventDefault()
            }
            function handleTouchMove(e) {
                for (var i=0; i < e.changedTouches.length; i++) {
                    var t = e.changedTouches[i]
                    websocket.send(JSON.stringify({x: t.pageX, y: t.pageY}));
                }
            }
            document.body.addEventListener('mousemove', handleMouseMove)
            document.body.addEventListener("touchstart", handleTouchStart);
            document.body.addEventListener("touchmove", handleTouchMove);
        </script>
    </body>
</html>
